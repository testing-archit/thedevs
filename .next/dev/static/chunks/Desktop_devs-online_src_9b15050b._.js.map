{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/archit/Desktop/devs-online/src/actions/auth.ts"],"sourcesContent":["'use server';\n\nimport { db } from '@/db';\nimport { users, sessions } from '@/db/schema';\nimport { eq } from 'drizzle-orm';\nimport { cookies } from 'next/headers';\nimport { redirect } from 'next/navigation';\nimport bcrypt from 'bcryptjs';\nimport { randomBytes } from 'crypto';\n\n// @ts-ignore\nexport async function login(prevState: any, formData: FormData) {\n    const email = formData.get('email') as string;\n    const password = formData.get('password') as string;\n\n    if (!email || !password) {\n        return { error: 'Please fill in all fields' };\n    }\n\n    try {\n        const user = await db.query.users.findFirst({\n            where: eq(users.email, email),\n        });\n\n        if (!user) {\n            return { error: 'Invalid credentials' };\n        }\n\n        const isValid = await bcrypt.compare(password, user.passwordHash);\n\n        if (!isValid) {\n            return { error: 'Invalid credentials' };\n        }\n\n        await createSession(user.id);\n    } catch (error) {\n        console.error('Login error:', error);\n        return { error: 'Something went wrong. Please try again.' };\n    }\n\n    redirect('/dashboard');\n}\n\n// @ts-ignore\nexport async function signup(prevState: any, formData: FormData) {\n    const name = formData.get('name') as string;\n    const email = formData.get('email') as string;\n    const password = formData.get('password') as string;\n    const course = formData.get('course') as string;\n    const specialization = formData.get('specialization') as string;\n    const yearOfStudy = parseInt(formData.get('yearOfStudy') as string);\n    const confirmPassword = formData.get('confirmPassword') as string;\n\n    if (!name || !email || !password || !course || !specialization || !yearOfStudy) {\n        return { error: 'Please fill in all fields' };\n    }\n\n    if (password !== confirmPassword) {\n        return { error: 'Passwords do not match' };\n    }\n\n    try {\n        const existingUser = await db.query.users.findFirst({\n            where: eq(users.email, email),\n        });\n\n        if (existingUser) {\n            return { error: 'User with this email already exists' };\n        }\n\n        const passwordHash = await bcrypt.hash(password, 10);\n\n        const [newUser] = await db.insert(users).values({\n            email,\n            passwordHash,\n            name,\n            course,\n            specialization,\n            yearOfStudy,\n            role: 'student',\n            subscription: 'free',\n        }).returning();\n\n        await createSession(newUser.id);\n    } catch (error) {\n        console.error('Signup error:', error);\n        return { error: 'Something went wrong. Please try again.' };\n    }\n\n    redirect('/dashboard');\n}\n\nexport async function logout() {\n    const cookieStore = await cookies();\n    const token = cookieStore.get('session_token')?.value;\n\n    if (token) {\n        await db.delete(sessions).where(eq(sessions.token, token));\n        cookieStore.delete('session_token');\n    }\n\n    redirect('/');\n}\n\nasync function createSession(userId: string) {\n    const token = randomBytes(64).toString('hex');\n    const expiresAt = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000); // 30 days\n\n    await db.insert(sessions).values({\n        userId,\n        token,\n        expiresAt,\n    });\n\n    const cookieStore = await cookies();\n    cookieStore.set('session_token', token, {\n        httpOnly: true,\n        secure: process.env.NODE_ENV === 'production',\n        sameSite: 'lax',\n        expires: expiresAt,\n    });\n}\n"],"names":[],"mappings":";;;;;;;MAWsB,wBAAA,WAAA,GAAA,IAAA,+QAAA,EAAA,8CAAA,oQAAA,EAAA,KAAA,GAAA,0QAAA,EAAA,yCAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/archit/Desktop/devs-online/src/components/auth/SubmitButton.tsx"],"sourcesContent":["'use client';\n\nimport { useFormStatus } from 'react-dom';\n\nexport function SubmitButton({ text }: { text: string }) {\n    const { pending } = useFormStatus();\n\n    return (\n        <button\n            type=\"submit\"\n            disabled={pending}\n            className=\"w-full py-3 bg-gradient-to-r from-primary to-secondary rounded-lg font-semibold hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n            {pending ? 'Processing...' : text}\n        </button>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAIO,SAAS,aAAa,EAAE,IAAI,EAAoB;;IACnD,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,kNAAa;IAEjC,qBACI,0NAAC;QACG,MAAK;QACL,UAAU;QACV,WAAU;kBAET,UAAU,kBAAkB;;;;;;AAGzC;GAZgB;;QACQ,kNAAa;;;KADrB"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///Users/archit/Desktop/devs-online/src/components/auth/LoginForm.tsx"],"sourcesContent":["'use client';\n\nimport { useActionState } from 'react';\nimport { login } from '@/actions/auth';\nimport { SubmitButton } from './SubmitButton';\nimport Link from 'next/link';\nimport Image from 'next/image';\n\nconst initialState = {\n    error: '',\n};\n\nexport function LoginForm() {\n    const [state, formAction] = useActionState(login, initialState);\n\n    return (\n        <div className=\"min-h-screen flex items-center justify-center py-12 px-4\">\n            <div className=\"glass-card rounded-2xl p-8 w-full max-w-md\">\n                <div className=\"text-center mb-8\">\n                    <Link href=\"/\">\n                        <Image src=\"/logo.png\" alt=\"The Devs\" width={64} height={64} className=\"h-16 w-auto mx-auto mb-4\" />\n                    </Link>\n                    <h1 className=\"text-2xl font-bold\">Welcome Back</h1>\n                    <p className=\"text-gray-400 mt-2\">Sign in to continue practicing</p>\n                </div>\n\n                {state?.error && (\n                    <div className=\"bg-red-500/20 border border-red-500/50 text-red-300 px-4 py-3 rounded-lg mb-6\">\n                        {state.error}\n                    </div>\n                )}\n\n                <form action={formAction} className=\"space-y-6\">\n                    <div>\n                        <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-300 mb-2\">Email</label>\n                        <input\n                            type=\"email\"\n                            id=\"email\"\n                            name=\"email\"\n                            required\n                            className=\"w-full px-4 py-3 bg-dark border border-white/10 rounded-lg focus:border-primary focus:outline-none transition-colors\"\n                            placeholder=\"you@bennett.edu.in\"\n                        />\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-300 mb-2\">Password</label>\n                        <input\n                            type=\"password\"\n                            id=\"password\"\n                            name=\"password\"\n                            required\n                            className=\"w-full px-4 py-3 bg-dark border border-white/10 rounded-lg focus:border-primary focus:outline-none transition-colors\"\n                            placeholder=\"••••••••\"\n                        />\n                    </div>\n\n                    <SubmitButton text=\"Sign In\" />\n                </form>\n\n                <div className=\"mt-6 text-center\">\n                    <p className=\"text-gray-400\">\n                        Don't have an account?\n                        <Link href=\"/signup\" className=\"text-primary hover:underline ml-1\">Sign up</Link>\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAQA,MAAM,eAAe;IACjB,OAAO;AACX;AAEO,SAAS;;IACZ,MAAM,CAAC,OAAO,WAAW,GAAG,IAAA,4MAAc,EAAC,+LAAK,EAAE;IAElD,qBACI,0NAAC;QAAI,WAAU;kBACX,cAAA,0NAAC;YAAI,WAAU;;8BACX,0NAAC;oBAAI,WAAU;;sCACX,0NAAC,uMAAI;4BAAC,MAAK;sCACP,cAAA,0NAAC,wKAAK;gCAAC,KAAI;gCAAY,KAAI;gCAAW,OAAO;gCAAI,QAAQ;gCAAI,WAAU;;;;;;;;;;;sCAE3E,0NAAC;4BAAG,WAAU;sCAAqB;;;;;;sCACnC,0NAAC;4BAAE,WAAU;sCAAqB;;;;;;;;;;;;gBAGrC,OAAO,uBACJ,0NAAC;oBAAI,WAAU;8BACV,MAAM,KAAK;;;;;;8BAIpB,0NAAC;oBAAK,QAAQ;oBAAY,WAAU;;sCAChC,0NAAC;;8CACG,0NAAC;oCAAM,SAAQ;oCAAQ,WAAU;8CAA+C;;;;;;8CAChF,0NAAC;oCACG,MAAK;oCACL,IAAG;oCACH,MAAK;oCACL,QAAQ;oCACR,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIpB,0NAAC;;8CACG,0NAAC;oCAAM,SAAQ;oCAAW,WAAU;8CAA+C;;;;;;8CACnF,0NAAC;oCACG,MAAK;oCACL,IAAG;oCACH,MAAK;oCACL,QAAQ;oCACR,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIpB,0NAAC,0LAAY;4BAAC,MAAK;;;;;;;;;;;;8BAGvB,0NAAC;oBAAI,WAAU;8BACX,cAAA,0NAAC;wBAAE,WAAU;;4BAAgB;0CAEzB,0NAAC,uMAAI;gCAAC,MAAK;gCAAU,WAAU;0CAAoC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM3F;GAzDgB;;QACgB,4MAAc;;;KAD9B"}}]
}